<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NExora - CBT Testing System</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    
</head>
<body class="bg-black text-white min-h-screen">
    <!-- Header -->
    <header class="bg-gray-900 border-b border-gray-800 sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-10 h-10 bg-orangered rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-orangered">NExora</h1>
                        <p class="text-sm text-gray-400">CBT Testing System</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div id="user-info" class="hidden">
                        <span class="text-sm text-gray-400">Welcome, </span>
                        <span id="username" class="font-semibold"></span>
                    </div>
                    <button id="logout-btn" onclick="logout()" class="hidden px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                        Logout
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Login Screen -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center p-6">
        <div class="bg-gray-900 rounded-2xl p-8 w-full max-w-md fade-in">
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-orangered rounded-full flex items-center justify-center mx-auto mb-4 pulse-animation">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <h2 class="text-3xl font-bold text-orangered mb-2">Welcome to NExora</h2>
                <p class="text-gray-400">Computer-Based Testing System</p>
            </div>
            
            <form id="login-form" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium mb-2">Username</label>
                    <input type="text" id="login-username" required class="w-full p-4 bg-gray-800 border border-gray-700 rounded-lg focus:border-orangered focus:outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Password</label>
                    <input type="password" id="login-password" required class="w-full p-4 bg-gray-800 border border-gray-700 rounded-lg focus:border-orangered focus:outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Role</label>
                    <select id="login-role" class="w-full p-4 bg-gray-800 border border-gray-700 rounded-lg focus:border-orangered focus:outline-none">
                        <option value="student">Student</option>
                        <option value="admin">Administrator</option>
                    </select>
                </div>
                
                <button type="submit" class="w-full bg-orangered hover:bg-red-600 text-white font-bold py-4 px-8 rounded-lg transition-colors">
                    Login
                </button>
            </form>
            
            <div class="mt-6 text-center text-sm text-gray-400">
                <p>Demo Credentials:</p>
                <p>Student: student/password | Admin: admin/password</p>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="student-dashboard" class="hidden container mx-auto px-6 py-8">
        <div class="mb-8">
            <h2 class="text-3xl font-bold mb-2">Student Dashboard</h2>
            <p class="text-gray-400">Select an exam to begin testing</p>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
            <div class="dashboard-card rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">Available Exams</h3>
                    <div class="w-12 h-12 bg-orangered/20 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-orangered" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                </div>
                <p class="text-3xl font-bold text-orangered" id="available-exams-count">3</p>
                <p class="text-sm text-gray-400">Ready to take</p>
            </div>
            
            <div class="dashboard-card rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">Completed</h3>
                    <div class="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                </div>
                <p class="text-3xl font-bold text-green-500" id="completed-exams-count">2</p>
                <p class="text-sm text-gray-400">Exams finished</p>
            </div>
            
            <div class="dashboard-card rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">Average Score</h3>
                    <div class="w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                </div>
                <p class="text-3xl font-bold text-blue-500">85%</p>
                <p class="text-sm text-gray-400">Overall performance</p>
            </div>
        </div>
        
        <div class="bg-gray-900 rounded-xl p-6">
            <h3 class="text-xl font-semibold mb-6">Available Exams</h3>
            <div id="exam-list" class="space-y-4">
                <!-- Exam items will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-dashboard" class="hidden container mx-auto px-6 py-8">
        <div class="mb-8">
            <h2 class="text-3xl font-bold mb-2">Admin Dashboard</h2>
            <p class="text-gray-400">Manage exams, questions, and view results</p>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="dashboard-card rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">Total Exams</h3>
                    <div class="w-10 h-10 bg-orangered/20 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-orangered" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                </div>
                <p class="text-2xl font-bold text-orangered">5</p>
            </div>
            
            <div class="dashboard-card rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">Active Students</h3>
                    <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                        </svg>
                    </div>
                </div>
                <p class="text-2xl font-bold text-green-500">24</p>
            </div>
            
            <div class="dashboard-card rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">Submissions</h3>
                    <div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                </div>
                <p class="text-2xl font-bold text-blue-500">156</p>
            </div>
            
            <div class="dashboard-card rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">Avg Score</h3>
                    <div class="w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                        </svg>
                    </div>
                </div>
                <p class="text-2xl font-bold text-purple-500">78%</p>
            </div>
        </div>
        
        <div class="grid lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2">
                <div class="bg-gray-900 rounded-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold">Exam Management</h3>
                        <button onclick="showCreateExam()" class="px-4 py-2 bg-orangered hover:bg-red-600 text-white rounded-lg transition-colors">
                            + Create Exam
                        </button>
                    </div>
                    <div id="admin-exam-list" class="space-y-4">
                        <!-- Admin exam list will be loaded here -->
                    </div>
                </div>
            </div>
            
            <div>
                <div class="bg-gray-900 rounded-xl p-6">
                    <h3 class="text-xl font-semibold mb-6">Recent Activity</h3>
                    <div class="space-y-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm font-medium">John completed Math Quiz</p>
                                <p class="text-xs text-gray-400">2 minutes ago</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm font-medium">New exam created</p>
                                <p class="text-xs text-gray-400">15 minutes ago</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm font-medium">Sarah started Physics Test</p>
                                <p class="text-xs text-gray-400">1 hour ago</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Exam Interface -->
    <div id="exam-interface" class="hidden">
        <!-- Exam Header -->
        <div class="bg-gray-900 border-b border-gray-800 sticky top-16 z-40">
            <div class="container mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div>
                        <h2 id="exam-title" class="text-xl font-bold">Exam Title</h2>
                        <p class="text-sm text-gray-400">
                            Question <span id="current-question">1</span> of <span id="total-questions">10</span>
                        </p>
                    </div>
                    
                    <div class="flex items-center space-x-6">
                        <div class="text-center">
                            <p class="text-sm text-gray-400">Time Remaining</p>
                            <p id="timer" class="text-2xl font-bold timer-normal">30:00</p>
                        </div>
                        
                        <button onclick="submitExam()" class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                            Submit Exam
                        </button>
                    </div>
                </div>
                
                <!-- Progress Bar -->
                <div class="mt-4">
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div id="progress-bar" class="progress-bar bg-orangered h-2 rounded-full" style="width: 10%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Question Content -->
        <div class="container mx-auto px-6 py-8">
            <div class="max-w-4xl mx-auto">
                <div id="question-container" class="question-card rounded-xl p-8 mb-8">
                    <!-- Question content will be loaded here -->
                </div>
                
                <!-- Navigation -->
                <div class="flex items-center justify-between">
                    <button id="prev-btn" onclick="previousQuestion()" class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                        ← Previous
                    </button>
                    
                    <div class="flex space-x-2">
                        <button onclick="flagQuestion()" id="flag-btn" class="px-4 py-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors">
                            🚩 Flag
                        </button>
                        <button onclick="clearAnswer()" class="px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                            Clear
                        </button>
                    </div>
                    
                    <button id="next-btn" onclick="nextQuestion()" class="px-6 py-3 bg-orangered hover:bg-red-600 text-white rounded-lg transition-colors">
                        Next →
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Question Navigator -->
        <div class="fixed right-4 top-1/2 transform -translate-y-1/2 bg-gray-900 rounded-xl p-4 border border-gray-700">
            <h4 class="text-sm font-semibold mb-3">Questions</h4>
            <div id="question-navigator" class="grid grid-cols-5 gap-2">
                <!-- Question navigation buttons will be loaded here -->
            </div>
            <div class="mt-4 text-xs text-gray-400">
                <div class="flex items-center space-x-2 mb-1">
                    <div class="w-3 h-3 bg-green-500 rounded"></div>
                    <span>Answered</span>
                </div>
                <div class="flex items-center space-x-2 mb-1">
                    <div class="w-3 h-3 bg-yellow-500 rounded"></div>
                    <span>Flagged</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 bg-gray-600 rounded"></div>
                    <span>Not Answered</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="results-screen" class="hidden container mx-auto px-6 py-8">
        <div class="max-w-4xl mx-auto text-center">
            <div class="bg-gray-900 rounded-2xl p-8 mb-8">
                <div class="text-6xl mb-4">🎉</div>
                <h2 class="text-3xl font-bold mb-4">Exam Completed!</h2>
                <p class="text-gray-400 mb-8">Thank you for completing the exam. Here are your results:</p>
                
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-gray-800 rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-2">Score</h3>
                        <p id="final-score" class="text-3xl font-bold text-orangered">85%</p>
                    </div>
                    
                    <div class="bg-gray-800 rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-2">Correct Answers</h3>
                        <p id="correct-answers" class="text-3xl font-bold text-green-500">17/20</p>
                    </div>
                    
                    <div class="bg-gray-800 rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-2">Time Taken</h3>
                        <p id="time-taken" class="text-3xl font-bold text-blue-500">25:30</p>
                    </div>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="reviewAnswers()" class="px-6 py-3 bg-orangered hover:bg-red-600 text-white rounded-lg transition-colors">
                        Review Answers
                    </button>
                    <button onclick="backToDashboard()" class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors">
                        Back to Dashboard
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Exam Modal -->
    <div id="create-exam-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-900 rounded-2xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto custom-scrollbar">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">Create New Exam</h3>
                <button onclick="closeCreateExam()" class="p-2 hover:bg-gray-800 rounded-lg transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <form id="create-exam-form" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium mb-2">Exam Title</label>
                    <input type="text" id="exam-title-input" required class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg focus:border-orangered focus:outline-none">
                </div>
                
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Duration (minutes)</label>
                        <input type="number" id="exam-duration" required min="1" value="30" class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg focus:border-orangered focus:outline-none">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Total Questions</label>
                        <input type="number" id="exam-questions-count" required min="1" value="10" class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg focus:border-orangered focus:outline-none">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Description</label>
                    <textarea id="exam-description" rows="3" class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg focus:border-orangered focus:outline-none"></textarea>
                </div>
                
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-orangered hover:bg-red-600 text-white py-3 rounded-lg transition-colors">
                        Create Exam
                    </button>
                    <button type="button" onclick="closeCreateExam()" class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let currentExam = null;
        let currentQuestionIndex = 0;
        let examTimer = null;
        let timeRemaining = 0;
        let userAnswers = {};
        let flaggedQuestions = new Set();

        // Sample data
        const users = {
            'student': { password: 'password', role: 'student', name: 'John Doe' },
            'admin': { password: 'password', role: 'admin', name: 'Admin User' }
        };

        const sampleExams = [
            {
                id: 1,
                title: 'Mathematics Quiz',
                description: 'Basic algebra and geometry questions',
                duration: 30,
                questions: [
                    {
                        id: 1,
                        question: 'What is 2 + 2?',
                        options: ['3', '4', '5', '6'],
                        correct: 1,
                        type: 'multiple-choice'
                    },
                    {
                        id: 2,
                        question: 'What is the square root of 16?',
                        options: ['2', '4', '6', '8'],
                        correct: 1,
                        type: 'multiple-choice'
                    },
                    {
                        id: 3,
                        question: 'If x + 5 = 12, what is x?',
                        options: ['5', '6', '7', '8'],
                        correct: 2,
                        type: 'multiple-choice'
                    }
                ],
                active: true
            },
            {
                id: 2,
                title: 'Science Test',
                description: 'Physics and chemistry fundamentals',
                duration: 45,
                questions: [
                    {
                        id: 1,
                        question: 'What is the chemical symbol for water?',
                        options: ['H2O', 'CO2', 'NaCl', 'O2'],
                        correct: 0,
                        type: 'multiple-choice'
                    },
                    {
                        id: 2,
                        question: 'What is the speed of light?',
                        options: ['300,000 km/s', '150,000 km/s', '450,000 km/s', '600,000 km/s'],
                        correct: 0,
                        type: 'multiple-choice'
                    }
                ],
                active: true
            },
            {
                id: 3,
                title: 'English Grammar',
                description: 'Grammar rules and vocabulary',
                duration: 25,
                questions: [
                    {
                        id: 1,
                        question: 'Which is the correct sentence?',
                        options: ['I are going', 'I am going', 'I is going', 'I be going'],
                        correct: 1,
                        type: 'multiple-choice'
                    }
                ],
                active: true
            }
        ];

        let exams = [...sampleExams];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            document.getElementById('create-exam-form').addEventListener('submit', handleCreateExam);
            
            // Check if user is already logged in
            const savedUser = localStorage.getItem('nexora-current-user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            }
        });

        // Authentication
        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const role = document.getElementById('login-role').value;
            
            if (users[username] && users[username].password === password && users[username].role === role) {
                currentUser = { username, ...users[username] };
                localStorage.setItem('nexora-current-user', JSON.stringify(currentUser));
                showDashboard();
            } else {
                showNotification('Invalid credentials!', 'error');
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('nexora-current-user');
            showLoginScreen();
        }

        function showLoginScreen() {
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('student-dashboard').classList.add('hidden');
            document.getElementById('admin-dashboard').classList.add('hidden');
            document.getElementById('exam-interface').classList.add('hidden');
            document.getElementById('results-screen').classList.add('hidden');
            document.getElementById('user-info').classList.add('hidden');
            document.getElementById('logout-btn').classList.add('hidden');
        }

        function showDashboard() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('exam-interface').classList.add('hidden');
            document.getElementById('results-screen').classList.add('hidden');
            
            document.getElementById('username').textContent = currentUser.name;
            document.getElementById('user-info').classList.remove('hidden');
            document.getElementById('logout-btn').classList.remove('hidden');
            
            if (currentUser.role === 'student') {
                document.getElementById('student-dashboard').classList.remove('hidden');
                document.getElementById('admin-dashboard').classList.add('hidden');
                loadStudentExams();
            } else {
                document.getElementById('admin-dashboard').classList.remove('hidden');
                document.getElementById('student-dashboard').classList.add('hidden');
                loadAdminExams();
            }
        }

        // Student functions
        function loadStudentExams() {
            const examList = document.getElementById('exam-list');
            const activeExams = exams.filter(exam => exam.active);
            
            examList.innerHTML = activeExams.map(exam => `
                <div class="bg-gray-800 rounded-lg p-6 flex items-center justify-between hover:bg-gray-700 transition-colors">
                    <div>
                        <h4 class="text-lg font-semibold mb-2">${exam.title}</h4>
                        <p class="text-gray-400 text-sm mb-2">${exam.description}</p>
                        <div class="flex items-center space-x-4 text-sm text-gray-500">
                            <span>📝 ${exam.questions.length} questions</span>
                            <span>⏱️ ${exam.duration} minutes</span>
                        </div>
                    </div>
                    <button onclick="startExam(${exam.id})" class="px-6 py-3 bg-orangered hover:bg-red-600 text-white rounded-lg transition-colors">
                        Start Exam
                    </button>
                </div>
            `).join('');
        }

        function startExam(examId) {
            currentExam = exams.find(exam => exam.id === examId);
            if (!currentExam) return;
            
            currentQuestionIndex = 0;
            userAnswers = {};
            flaggedQuestions.clear();
            timeRemaining = currentExam.duration * 60; // Convert to seconds
            
            showExamInterface();
            startTimer();
            loadQuestion();
            updateQuestionNavigator();
        }

        function showExamInterface() {
            document.getElementById('student-dashboard').classList.add('hidden');
            document.getElementById('exam-interface').classList.remove('hidden');
            
            document.getElementById('exam-title').textContent = currentExam.title;
            document.getElementById('total-questions').textContent = currentExam.questions.length;
        }

        function loadQuestion() {
            const question = currentExam.questions[currentQuestionIndex];
            const container = document.getElementById('question-container');
            
            container.innerHTML = `
                <div class="mb-6">
                    <h3 class="text-2xl font-semibold mb-4">Question ${currentQuestionIndex + 1}</h3>
                    <p class="text-lg text-gray-300 mb-6">${question.question}</p>
                </div>
                
                <div class="space-y-3">
                    ${question.options.map((option, index) => `
                        <button onclick="selectAnswer(${index})" class="option-button w-full p-4 bg-gray-800 border border-gray-700 rounded-lg text-left hover:border-orangered transition-colors ${userAnswers[question.id] === index ? 'option-selected' : ''}">
                            <span class="font-semibold mr-3">${String.fromCharCode(65 + index)}.</span>
                            ${option}
                        </button>
                    `).join('')}
                </div>
            `;
            
            // Update UI
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            updateProgressBar();
            updateNavigationButtons();
            updateFlagButton();
        }

        function selectAnswer(optionIndex) {
            const question = currentExam.questions[currentQuestionIndex];
            userAnswers[question.id] = optionIndex;
            
            // Update visual selection
            const options = document.querySelectorAll('.option-button');
            options.forEach((option, index) => {
                option.classList.remove('option-selected');
                if (index === optionIndex) {
                    option.classList.add('option-selected');
                }
            });
            
            updateQuestionNavigator();
        }

        function nextQuestion() {
            if (currentQuestionIndex < currentExam.questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        function jumpToQuestion(index) {
            currentQuestionIndex = index;
            loadQuestion();
        }

        function flagQuestion() {
            const question = currentExam.questions[currentQuestionIndex];
            if (flaggedQuestions.has(question.id)) {
                flaggedQuestions.delete(question.id);
            } else {
                flaggedQuestions.add(question.id);
            }
            updateFlagButton();
            updateQuestionNavigator();
        }

        function clearAnswer() {
            const question = currentExam.questions[currentQuestionIndex];
            delete userAnswers[question.id];
            loadQuestion();
            updateQuestionNavigator();
        }

        function updateProgressBar() {
            const progress = ((currentQuestionIndex + 1) / currentExam.questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        function updateNavigationButtons() {
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            document.getElementById('next-btn').textContent = 
                currentQuestionIndex === currentExam.questions.length - 1 ? 'Finish' : 'Next →';
        }

        function updateFlagButton() {
            const question = currentExam.questions[currentQuestionIndex];
            const flagBtn = document.getElementById('flag-btn');
            if (flaggedQuestions.has(question.id)) {
                flagBtn.textContent = '🚩 Unflag';
                flagBtn.classList.add('bg-yellow-700');
            } else {
                flagBtn.textContent = '🚩 Flag';
                flagBtn.classList.remove('bg-yellow-700');
            }
        }

        function updateQuestionNavigator() {
            const navigator = document.getElementById('question-navigator');
            navigator.innerHTML = currentExam.questions.map((question, index) => {
                let className = 'w-8 h-8 rounded text-sm font-semibold transition-colors cursor-pointer ';
                
                if (userAnswers[question.id] !== undefined) {
                    className += 'bg-green-500 text-white';
                } else if (flaggedQuestions.has(question.id)) {
                    className += 'bg-yellow-500 text-white';
                } else {
                    className += 'bg-gray-600 text-gray-300 hover:bg-gray-500';
                }
                
                if (index === currentQuestionIndex) {
                    className += ' ring-2 ring-orangered';
                }
                
                return `<button onclick="jumpToQuestion(${index})" class="${className}">${index + 1}</button>`;
            }).join('');
        }

        function startTimer() {
            examTimer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(examTimer);
                    submitExam();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            const timerElement = document.getElementById('timer');
            timerElement.textContent = display;
            
            // Change color based on time remaining
            timerElement.className = 'text-2xl font-bold ';
            if (timeRemaining > 300) { // > 5 minutes
                timerElement.className += 'timer-normal';
            } else if (timeRemaining > 60) { // > 1 minute
                timerElement.className += 'timer-warning';
            } else {
                timerElement.className += 'timer-critical countdown-warning';
            }
        }

        function submitExam() {
            if (examTimer) {
                clearInterval(examTimer);
            }
            
            // Calculate results
            let correctAnswers = 0;
            currentExam.questions.forEach(question => {
                if (userAnswers[question.id] === question.correct) {
                    correctAnswers++;
                }
            });
            
            const score = Math.round((correctAnswers / currentExam.questions.length) * 100);
            const timeTaken = (currentExam.duration * 60) - timeRemaining;
            
            showResults(score, correctAnswers, timeTaken);
        }

        function showResults(score, correctAnswers, timeTaken) {
            document.getElementById('exam-interface').classList.add('hidden');
            document.getElementById('results-screen').classList.remove('hidden');
            
            document.getElementById('final-score').textContent = `${score}%`;
            document.getElementById('correct-answers').textContent = `${correctAnswers}/${currentExam.questions.length}`;
            
            const minutes = Math.floor(timeTaken / 60);
            const seconds = timeTaken % 60;
            document.getElementById('time-taken').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function reviewAnswers() {
            // Implementation for answer review
            showNotification('Answer review feature coming soon!', 'info');
        }

        function backToDashboard() {
            document.getElementById('results-screen').classList.add('hidden');
            showDashboard();
        }

        // Admin functions
        function loadAdminExams() {
            const examList = document.getElementById('admin-exam-list');
            
            examList.innerHTML = exams.map(exam => `
                <div class="bg-gray-800 rounded-lg p-4 flex items-center justify-between">
                    <div>
                        <h4 class="font-semibold">${exam.title}</h4>
                        <p class="text-sm text-gray-400">${exam.questions.length} questions • ${exam.duration} minutes</p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editExam(${exam.id})" class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors">
                            Edit
                        </button>
                        <button onclick="deleteExam(${exam.id})" class="px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors">
                            Delete
                        </button>
                        <button onclick="toggleExamStatus(${exam.id})" class="px-3 py-1 ${exam.active ? 'bg-green-600 hover:bg-green-700' : 'bg-gray-600 hover:bg-gray-700'} text-white rounded text-sm transition-colors">
                            ${exam.active ? 'Active' : 'Inactive'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showCreateExam() {
            document.getElementById('create-exam-modal').classList.remove('hidden');
        }

        function closeCreateExam() {
            document.getElementById('create-exam-modal').classList.add('hidden');
            document.getElementById('create-exam-form').reset();
        }

        function handleCreateExam(e) {
            e.preventDefault();
            
            const title = document.getElementById('exam-title-input').value;
            const duration = parseInt(document.getElementById('exam-duration').value);
            const questionCount = parseInt(document.getElementById('exam-questions-count').value);
            const description = document.getElementById('exam-description').value;
            
            const newExam = {
                id: exams.length + 1,
                title,
                description,
                duration,
                questions: generateSampleQuestions(questionCount),
                active: true
            };
            
            exams.push(newExam);
            loadAdminExams();
            closeCreateExam();
            showNotification('Exam created successfully!', 'success');
        }

        function generateSampleQuestions(count) {
            const sampleQuestions = [
                {
                    question: 'What is the capital of France?',
                    options: ['London', 'Berlin', 'Paris', 'Madrid'],
                    correct: 2
                },
                {
                    question: 'What is 10 × 5?',
                    options: ['45', '50', '55', '60'],
                    correct: 1
                },
                {
                    question: 'Which planet is closest to the Sun?',
                    options: ['Venus', 'Mercury', 'Earth', 'Mars'],
                    correct: 1
                }
            ];
            
            const questions = [];
            for (let i = 0; i < count; i++) {
                const template = sampleQuestions[i % sampleQuestions.length];
                questions.push({
                    id: i + 1,
                    ...template,
                    type: 'multiple-choice'
                });
            }
            
            return questions;
        }

        function editExam(examId) {
            showNotification('Edit exam feature coming soon!', 'info');
        }

        function deleteExam(examId) {
            if (confirm('Are you sure you want to delete this exam?')) {
                exams = exams.filter(exam => exam.id !== examId);
                loadAdminExams();
                showNotification('Exam deleted successfully!', 'success');
            }
        }

        function toggleExamStatus(examId) {
            const exam = exams.find(e => e.id === examId);
            if (exam) {
                exam.active = !exam.active;
                loadAdminExams();
                showNotification(`Exam ${exam.active ? 'activated' : 'deactivated'}!`, 'info');
            }
        }

        // Utility functions
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg text-white z-50 fade-in ${
                type === 'success' ? 'bg-green-600' : 
                type === 'error' ? 'bg-red-600' : 
                type === 'info' ? 'bg-blue-600' : 'bg-gray-600'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Close modal on outside click
        document.getElementById('create-exam-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCreateExam();
            }
        });

        // Prevent exam cheating (basic measures)
        document.addEventListener('keydown', function(e) {
            if (currentExam && !document.getElementById('exam-interface').classList.contains('hidden')) {
                // Disable F12, Ctrl+Shift+I, Ctrl+U, etc.
                if (e.key === 'F12' || 
                    (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                    (e.ctrlKey && e.key === 'u')) {
                    e.preventDefault();
                    showNotification('Developer tools are disabled during exam!', 'error');
                }
            }
        });

        // Warn about page refresh during exam
        window.addEventListener('beforeunload', function(e) {
            if (currentExam && !document.getElementById('exam-interface').classList.contains('hidden')) {
                e.preventDefault();
                e.returnValue = 'Are you sure you want to leave? Your exam progress will be lost.';
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'968c112dd40e0088',t:'MTc1NDEyMTg5NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>